{"instance_id": "astropy__astropy-12907", "model_patch": "diff --git a/astropy/modeling/separable.py b/astropy/modeling/separable.py\nindex abc1234..def5678 100644\n--- a/astropy/modeling/separable.py\n+++ b/astropy/modeling/separable.py\n@@ -XXX,YYY +XXX,YYY @@\n def _separability_matrix(model, inputs_map=None):\n     \"\"\"\n     Internal implementation of separability_matrix.\n@@ -AAA,BBB +AAA,CCC @@\n         n_inputs = model.n_inputs\n         n_outputs = model.n_outputs\n         \n+        # Handle nested CompoundModels by recursing into their structure\n+        if isinstance(model, CompoundModel) and model._leaflist:\n+            # Reconstruct the full compound model structure from leaflist\n+            # to properly compute separability\n+            full_model = model._compound_from_leaflist(model._leaflist)\n+            if hasattr(full_model, '_input_dependencies'):\n+                return full_model._input_dependencies\n+        \n         if inputs_map is None:\n             inputs_map = {}", "model_name_or_path": "custom"}
{"instance_id": "astropy__astropy-14182", "model_patch": "diff --git a/astropy/io/ascii/core.py b/astropy/io/ascii/core.py\nindex abc1234..def5678 100644\n--- a/astropy/io/ascii/core.py\n+++ b/astropy/io/ascii/core.py\n@@ -1716,6 +1716,7 @@ class Rst(BaseWriter):\n     delimiter_pad = ' '\n     delimiter = '|'\n \n+    header_rows = None\n     def __init__(self):\n         super().__init__()\n         self.col_alignments = {}\n@@ -1727,6 +1728,24 @@ class Rst(BaseWriter):\n         self.line_length = 0\n         self.line_lengths = []\n \n+    def write_header_rows(self, cols):\n+        \"\"\"\n+        Write header rows based on header_rows specification.\n+        \"\"\"\n+        if self.header_rows is None:\n+            # Default RST behavior: write column names\n+            header_lines = [self._get_column_names_line(cols)]\n+        else:\n+            header_lines = []\n+            for row_type in self.header_rows:\n+                if row_type == \"name\":\n+                    header_lines.append(self._get_column_names_line(cols))\n+                elif row_type == \"unit\":\n+                    header_lines.append(self._get_column_units_line(cols))\n+                else:\n+                    raise ValueError(f\"Unsupported header_rows type: {row_type}\")\n+        return header_lines\n+\n     def write(self, table):\n         \"\"\"Write table in RST table format.\"\"\"\n         cols = table.colnames\n@@ -1734,17 +1753,20 @@ class Rst(BaseWriter):\n \n         # Column names\n         self.write_line(\".. table::\")\n-        self.write_line(\"\")\n-        self.write_line(\"   +\".join([\"=\" + self.get_col_widths_line(cols)[i] * \"=\" \n-                                    for i in range(len(cols))]) + \"+\")\n-        self.write_line(\"   | \" + \" | \".join([self.get_col_name(col) for col in cols]) + \" |\")\n-        self.write_line(\"   +\".join([\"=\" + self.get_col_widths_line(cols)[i] * \"=\" \n-                                    for i in range(len(cols))]) + \"+\")\n+        self.write_line(\"\")\n+\n+        # Write header rows\n+        header_lines = self.write_header_rows(cols)\n+        for line in header_lines:\n+            self.write_line(f\"   {line}\")\n \n         # Data rows\n         for row in table:\n             self.write_row(row)\n \n+        # Closing separator line\n+        self.write_line(\"   \" + self._get_separator_line(cols))\n+\n         # Closing separator line\n         self.write_line(\"   +\".join([\"=\" + self.get_col_widths_line(cols)[i] * \"=\"\n                                      for i in range(len(cols))]) + \"+\")", "model_name_or_path": "custom"}
